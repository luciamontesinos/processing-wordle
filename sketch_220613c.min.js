function startGame(){for(let e=0;e<wordTable.getRowCount();e++)wordList.push(wordTable.getRow(e).arr[0]);let e=Math.floor(Math.random()*(wordTable.getRowCount()+1));wordToGuess=wordTable.getString(e,0).toUpperCase(),console.log(wordToGuess),0==win&&endGame()}function endGame(){1==win&&String(numberOfAttempts)}function checkWord(){if(usedWords.includes(wordToCheck.join("")))console.log("The word has already been used");else{usedWords.push(wordToCheck.join(""));for(let e=0;e<numberOfLetters;e++){let t=characters.indexOf(wordToCheck[e].toLowerCase());wordToCheck[e]==wordToGuess?(currentMode[e]="correct",currentKeyMode[t]="correct",allSlotsMode[(currentAttempt-1)*numberOfLetters+e]="correct",allLetters[(currentAttempt-1)*numberOfLetters+e]=wordToCheck[e]):wordToGuess.includes(wordToCheck[e])?(currentMode[e]="semi",currentKeyMode[t]="semi",allSlotsMode[(currentAttempt-1)*numberOfLetters+e]="semi",allLetters[(currentAttempt-1)*numberOfLetters+e]=wordToCheck[e]):(currentMode[e]="error",currentKeyMode[t]="error",allSlotsMode[(currentAttempt-1)*numberOfLetters+e]="error",allLetters[(currentAttempt-1)*numberOfLetters+e]=wordToCheck[e])}}for(let e=0;e<numberOfAttempts;e++)for(let t=0;t<numberOfLetters;t++)slots[e][t].show(allLetters[e*numberOfLetters+t],allSlotsMode[e*numberOfLetters+t]);wordToGuess==currentWord.join("")&&(win=!0,endGame())}let menuContainer,canvasContainer,processLetter,menuButton,gigantLetter,handlee,inter,kinetip,arrow,bottomMessage,confirmImage,rejectImage,resumeGameButton,newGameButton,changeHandButton,cursor,eraser,processTextTitle,processTextSubtitle,processErrorText,processingText,closingButton,drawMode=!0,value=0,slots=[],keys=[];const characters="abcdefghijklmnopqrstuvwxyzåæø",charactersWhiteList="abcdefghijklmnopqrstuvwxyzåæøABCDEFGHIJKLMNOPQRSTUVWXYZAÅÆØ",numberOfLetters=5,numberOfAttempts=6,wordsPath="wordlist.csv";let wordTable,wordToGuess,wordToCheck,hx,hy,hands,mode,drawCanvas,tesseractWorker,currentAttempt=1,inGame=!1,wordList=[],usedWords=[],win=!1,currentWordRow=[],currentWord=Array(numberOfLetters).fill(""),currentMode=Array(numberOfLetters).fill("empty"),currentKeyMode=Array(characters.length).fill("empty"),allSlotsMode=Array(numberOfLetters*numberOfAttempts).fill("empty"),allLetters=Array(numberOfLetters*numberOfAttempts).fill(""),currentLetterWord=0,hasCheckedLetter=!1,hasCheckedWord=!1,guessedLetter=[],letterToShow="",selectedMenuButton=!1,selectedHelpButton=!1,openWindow=!1,niceTry="Nice try! Let's go for another word",systemRecognice="The system has recognized the following letter",isThisLetter="Is this the letter you drew?",oops="Oops...the letter could not be recognized. Try to draw it again!",loading="Processing letter...",processing=!1,xp=0,yp=0;const s1=e=>{e.preload=(()=>{wordTable=e.loadTable(wordsPath),kinetip=e.loadImage("Kinetip.png"),arrow=e.loadImage("arrow.png")}),e.drawGrid=(()=>{e.noStroke(),e.fill(128);for(let e=0;e<numberOfAttempts;e++)for(let t=0;t<numberOfLetters;t++)slots[e][t].show(allLetters[e*numberOfLetters+t],allSlotsMode[e*numberOfLetters+t]);for(let e=0;e<characters.length;e++)keys[e].show(currentKeyMode[e]);bottomMessage.show(niceTry),e.image(arrow,canvasWidth/2.5*2,document.documentElement.clientHeight/10*8.3),e.image(kinetip,canvasWidth/2.5+document.getElementById("canvas_grid").offsetWidth/15*1.2,document.documentElement.clientHeight/18)}),e.setup=(()=>{keys=[],slots=[],canvasWidth=document.getElementById("canvas_grid").offsetWidth,canvasHeight=document.documentElement.clientHeight,e.createCanvas(canvasWidth,canvasHeight),e.background(250),size=document.getElementById("canvas_grid").offsetWidth/15;for(let t=0;t<numberOfAttempts;t++){slots.push([]),y=t*(size+size/4)+canvasHeight/5;for(let n=0;n<numberOfLetters;n++)x=canvasWidth/2.5+1.2*n*size,slots[t].push(new Slot(x,y,size,t,n,e))}keySize=document.getElementById("canvas_grid").offsetWidth/26;for(let t=0;t<10;t++)letter=characters.charAt(t),x=1*(keySize+keySize/4)+canvasWidth/10,y=canvasHeight/4+t*(keySize+keySize/5),keys.push(new Key(x,y,letter,keySize,keySize,e));for(let t=10;t<20;t++)letter=characters.charAt(t),x=2*(keySize+keySize/4)+canvasWidth/10,y=canvasHeight/4+(t-10)*(keySize+keySize/5),keys.push(new Key(x,y,letter,keySize,keySize,e));for(let t=20;t<=characters.length;t++)letter=characters.charAt(t),x=3*(keySize+keySize/4)+canvasWidth/10,y=canvasHeight/4+(t-20)*(keySize+keySize/5),keys.push(new Key(x,y,letter,keySize,keySize,e));bottomMessage=new Text("",canvasWidth/2.5,document.documentElement.clientHeight/10*9,25,"black","-",e),e.drawGrid(),0==inGame&&(inGame=!0,startGame())}),e.draw=(()=>{e.setup()})};let gridP5=new p5(s1,"canvas_grid");const s2=e=>{e.preload=(()=>{handlee=e.loadFont("Handlee-Regular.ttf"),inter=e.loadFont("Inter.ttf")}),e.drawDots=(()=>{var t=document.documentElement.clientHeight,n=document.getElementById("canvas_draw").offsetWidth,o=2,r=30,s=30;e.strokeWeight(2),e.stroke(0),e.fill(0);for(var a=20;a<n;a+=r)for(var d=20;d<t;d+=s)e.point(a-o/2,d-o/2)}),e.fingersUp=(e=>e[0][4].y<e[0][2].y&&e[0][8].y<e[0][6].y&&e[0][12].y<e[0][10].y&&e[0][16].y<e[0][14].y&&e[0][20].y<e[0][18].y?"move":e[0][8].y<e[0][6].y&&e[0][7].y<e[0][12].y&&e[0][7].y<e[0][16].y&&e[0][7].y<e[0][20].y?"draw":e[0][4].y<e[0][2].y&&e[0][3].y<e[0][8].y&&e[0][3].y<e[0][12].y&&e[0][3].y<e[0][16].y&&e[0][3].y<e[0][20].y?"confirm":e[0][4].y>e[0][2].y&&e[0][3].y>e[0][8].y&&e[0][3].y>e[0][12].y&&e[0][3].y>e[0][16].y&&e[0][3].y>e[0][20].y?"cancel":e[0][8].y>e[0][6].y&&e[0][12].y>e[0][10].y&&e[0][16].y>e[0][14].y&&e[0][20].y>e[0][18].y?"click":"unknown"),e.onResults=(t=>{document.getElementById("canvas_grid").offsetWidth;if(handInUse="",t.multiHandedness)for(const e of t.multiHandedness)"Right"==e.label?handInUse="Left":handInUse="Right";if(t.multiHandLandmarks)for(const n of t.multiHandLandmarks){if(mode=e.fingersUp(t.multiHandLandmarks),hx=document.getElementById("canvas_draw").offsetWidth-t.multiHandLandmarks[0][8].x*document.getElementById("canvas_draw").offsetWidth,hy=t.multiHandLandmarks[0][8].y*document.documentElement.clientHeight,console.log(handInUse,mode),processLetter.contains(hx,hy)){if("Right"==handInUse&&"click"==mode&&0==hasCheckedLetter){processLetter.hide(),helpButton.hide(),menuButton.hide(),navigateButton.hide();for(let e=0;e<numberOfLetters;e++)currentWordRow[e].hide();e.drawDots(),drawP5.filter(e.DILATE),drawP5.filter(e.DILATE),drawP5.filter(e.DILATE),drawP5.filter(e.THRESHOLD),processing=!0,Tesseract.recognize(drawP5.drawingContext.canvas,{lang:"dan",tessedit_pageseg_mode:"10",tessedit_char_whitelist:charactersWhiteList}).catch(e=>{console.error(e)}).then(t=>{if(processing=!1,console.log(t),confidence=t.confidence,letterToShow=t.text[0],charactersWhiteList.includes(letterToShow))processing=!1,hasCheckedLetter=!0,e.background(255),e.drawDots(),gigantLetter.show(letterToShow),processTextTitle.show(systemRecognice),processTextSubtitle.show(isThisLetter);else{processing=!1,e.background(255),e.drawDots(),processLetter.show(),helpButton.show(),menuButton.show(),navigateButton.show();for(let e=0;e<numberOfLetters;e++)currentWordRow[e].show(currentWord[e],currentMode[e]);hasCheckedLetter=!1}})}}else if(helpButton.contains(hx,hy)){if("Right"==handInUse&&"click"==mode){selectedHelpButton=!0,processLetter.hide(),helpButton.hide(),menuButton.hide(),navigateButton.hide();for(let e=0;e<numberOfLetters;e++)currentWordRow[e].hide();e.background(255),closingButton.show()}}else if(closingButton.contains(hx,hy)){if("Right"==handInUse&&"click"==mode){selectedHelpButton=!1,closingButton.hide(),menuContainer.hide(),newGameButton.hide(),resumeGameButton.hide(),changeHandButton.hide(),e.background(255),e.drawDots(),menuButton.show(),processLetter.show(),helpButton.show(),navigateButton.show();for(let e=0;e<numberOfLetters;e++)currentWordRow[e].show(currentWord[e],currentMode[e])}}else if(resumeGameButton.contains(hx,hy)){if("Right"==handInUse&&"click"==mode){closingButton.hide(),menuContainer.hide(),newGameButton.hide(),resumeGameButton.hide(),changeHandButton.hide(),e.background(255),e.drawDots(),menuButton.show(),processLetter.show(),helpButton.show(),navigateButton.show();for(let e=0;e<numberOfLetters;e++)currentWordRow[e].show(currentWord[e],currentMode[e])}}else if(newGameButton.contains(hx,hy)){if("Right"==handInUse&&"click"==mode){closingButton.hide(),startGame(),menuContainer.hide(),newGameButton.hide(),resumeGameButton.hide(),changeHandButton.hide(),e.background(255),e.drawDots(),menuButton.show(),processLetter.show(),helpButton.show(),navigateButton.show(),currentWordRow=[],currentWord=Array(numberOfLetters).fill(""),currentMode=Array(numberOfLetters).fill("empty"),currentLetterWord=0,currentAttempt=0,size=document.getElementById("canvas_draw").offsetWidth/20,y=document.documentElement.clientHeight-2*size;for(let t=0;t<numberOfLetters;t++)x=(document.getElementById("canvas_draw").offsetWidth+150)/2-numberOfLetters/2*1.2*size+1.2*t*size,currentWordRow.push(new Slot(x,y,size,0,t,e));for(let e=0;e<numberOfLetters;e++)currentWordRow[e].show(currentWord[e],currentMode[e])}}else if(menuButton.contains(hx,hy)){if("Right"==handInUse&&"click"==mode)if(0==selectedMenuButton){menuButton.hide(),processLetter.hide(),helpButton.hide();for(let e=0;e<numberOfLetters;e++)currentWordRow[e].hide();e.background(255),e.drawDots(),navigateButton.show(),closingButton.show(),menuContainer.show(),newGameButton.show("menuButton"),resumeGameButton.show("menuButton"),changeHandButton.show("menuButton")}else{selectedMenuButton=!1,e.background(255),e.drawDots(),menuButton.show(),processLetter.show(),helpButton.show(),navigateButton.show();for(let e=0;e<numberOfLetters;e++)currentWordRow[e].show(currentWord[e],currentMode[e])}}else if(navigateButton.contains(hx,hy))"Right"==handInUse&&"move"==mode&&(console.log("Navigate"),navigateButton.hide(),helpButton.hide(),e.toggle(),navigateBackButton.show());else if(navigateBackButton.contains(hx,hy)){if("Right"==handInUse&&"move"==mode){console.log("Navigate back"),e.toggle(),navigateBackButton.hide(),e.background(255),e.drawDots(),menuButton.show(),processLetter.show(),helpButton.show(),navigateButton.show();for(let e=0;e<numberOfLetters;e++)currentWordRow[e].show(currentWord[e],currentMode[e])}}else if("Right"==handInUse)"draw"!=mode||openWindow||(0==xp&&0==yp?(xp=hx,yp=hy):(e.stroke(0,101,152),e.strokeWeight(30),e.line(xp,yp,hx,hy),xp=hx,yp=hy));else if("Left"==handInUse){if("confirm"!=mode&&"cancel"!=mode&"draw"!=mode&&"move"!=mode&&!openWindow)if(processLetter.contains(hx,hy)||helpButton.contains(hx,hy)||menuButton.contains(hx,hy)||navigateButton.contains(hx,hy)||navigateBackButton.contains(hx,hy));else{e.stroke(255),e.strokeWeight(100),0==xp&&0==yp&&(xp=hx,yp=hy),e.line(xp,yp,hx,hy),xp=hx,yp=hy,e.drawDots(),menuButton.show(),processLetter.show(),helpButton.show(),navigateButton.show();for(let e=0;e<numberOfLetters;e++)currentWordRow[e].show(currentWord[e],currentMode[e])}xp=hx,yp=hy}if("confirm"==mode)if(1==hasCheckedLetter){gigantLetter.hide(),e.background(255),e.drawDots(),currentWord[currentLetterWord]=letterToShow,currentMode[currentLetterWord]="empty",currentLetterWord++,currentMode[currentLetterWord]="current",currentLetterWord==numberOfLetters&&(hasCheckedWord=!0),processLetter.show(),helpButton.show(),menuButton.show(),navigateButton.show(),hx=document.getElementById("canvas_draw").offsetWidth/2,hy=document.documentElement.clientHeight,hasCheckedLetter=!1;for(let e=0;e<numberOfLetters;e++)currentWordRow[e].show(currentWord[e],currentMode[e])}else if(1==hasCheckedWord){hasCheckedWord=!1,e.toggle(),navigateButton.hide(),navigateBackButton.show(),console.log(currentWord),wordToCheck=[...currentWord],checkWord(),currentAttempt++,currentWordRow=[],currentWord=Array(numberOfLetters).fill(""),currentMode=Array(numberOfLetters).fill("empty"),currentLetterWord=0,size=document.getElementById("canvas_draw").offsetWidth/20,y=document.documentElement.clientHeight-2*size;for(let t=0;t<numberOfLetters;t++)x=(document.getElementById("canvas_draw").offsetWidth+150)/2-numberOfLetters/2*1.2*size+1.2*t*size,currentWordRow.push(new Slot(x,y,size,0,t,e))}if("cancel"==mode)if(1==hasCheckedLetter){gigantLetter.hide(),e.background(255),e.drawDots(),processLetter.show(),helpButton.show(),menuButton.show(),navigateButton.show(),hx=document.getElementById("canvas_draw").offsetWidth/2,hy=document.documentElement.clientHeight,hasCheckedLetter=!1;for(let e=0;e<numberOfLetters;e++)currentWordRow[e].show(currentWord[e],currentMode[e])}else 1==hasCheckedWord&&(hasCheckedWord=!1)}}),e.setup=(()=>{e.pixelDensity(3),drawCanvas=e.createCanvas(document.getElementById("canvas_draw").offsetWidth,document.documentElement.clientHeight),e.background(255),currentWord=[],processLetter=new Button("Proccess\nLetter",document.getElementById("canvas_draw").offsetWidth-150,document.documentElement.clientHeight-150,200,28,"green","green",255,"br",e),menuButton=new Button("Menu",document.getElementById("canvas_draw").offsetWidth-150,150,200,28,[230,242,248],[230,242,248],[0,101,152],"tr",e),helpButton=new Button("Help",300,document.documentElement.clientHeight-150,200,50,[230,242,248],[230,242,248],[0,101,152],"tl",e),closingButton=new Button("X",300,150,100,100,[230,242,248],[230,242,248],[0,101,152],"tl",e),navigateButton=new Toggle(">>",0,0,document.getElementById("canvas_draw").offsetWidth/10,document.documentElement.clientHeight,60,[102,177,214],[102,177,214],"white","l",e),navigateBackButton=new Toggle("<<",document.getElementById("canvas_draw").offsetWidth-document.getElementById("canvas_draw").offsetWidth/3,0,document.getElementById("canvas_draw").offsetWidth/10,document.documentElement.clientHeight,60,[102,177,214],[102,177,214],"white","r",e),menuContainer=new Container(350,175,document.getElementById("canvas_draw").offsetWidth/1.5,document.getElementById("canvas_draw").offsetWidth/4,"white","white",e),menuOptionSize=document.getElementById("canvas_draw").offsetWidth/8,resumeGameButton=new Key(375+menuOptionSize/2,250,"Resume\nGame",menuOptionSize,menuOptionSize,e),newGameButton=new Key(375+2*menuOptionSize,250,"New\nGame",menuOptionSize,menuOptionSize,e),changeHandButton=new Key(375+3*menuOptionSize+menuOptionSize/2,250,"Change\nHand",menuOptionSize,menuOptionSize,e),gigantLetter=new Text(letterToShow,document.getElementById("canvas_draw").offsetWidth/2,document.documentElement.clientHeight/5*3,400,0,"-",e),processTextTitle=new Text(systemRecognice,document.getElementById("canvas_image").offsetWidth/2,document.documentElement.clientHeight/8,40,0,"-",e),processTextSubtitle=new Text(isThisLetter,document.getElementById("canvas_image").offsetWidth/2,document.documentElement.clientHeight/4,30,0,"-",e),processErrorText=new Text(oops,document.getElementById("canvas_image").offsetWidth/2,document.documentElement.clientHeight/2,30,0,"-",e),processingText=new Text(loading,document.getElementById("canvas_image").offsetWidth/2,document.documentElement.clientHeight/5*4,30,0,"-",e),size=document.getElementById("canvas_draw").offsetWidth/20,y=document.documentElement.clientHeight-2*size;for(let t=0;t<numberOfLetters;t++)x=(document.getElementById("canvas_draw").offsetWidth+150)/2-numberOfLetters/2*1.2*size+1.2*t*size,currentWordRow.push(new Slot(x,y,size,0,t,e));e.drawDots(),videoElement=document.getElementsByClassName("input_video")[0],hands=new Hands({locateFile:e=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${e}`}),hands.setOptions({maxNumHands:2,modelComplexity:1,minDetectionConfidence:.75,minTrackingConfidence:.75});const t=new Camera(videoElement,{onFrame:async()=>{await hands.send({image:videoElement})},width:1280,height:720});t.start()}),e.draw=(()=>{e.noLoop(),hands.onResults(e.onResults),processLetter.show(),menuButton.show(),helpButton.show(),navigateButton.show();for(let e=0;e<numberOfLetters;e++)currentLetterWord==e&&(currentMode[e]="current"),currentWordRow[e].show(currentWord[e],currentMode[e])}),e.toggle=(()=>{1==drawMode&&(document.getElementById("canvas_grid").classList.toggle("toggle"),openWindow=!openWindow)})};let drawP5=new p5(s2,"canvas_draw");const s3=e=>{e.setup=(()=>{e.createCanvas(document.getElementById("canvas_pointer").offsetWidth,document.documentElement.clientHeight),e.noStroke(),cursor=e.loadImage("cursor.png"),eraser=e.loadImage("eraser.png")}),e.draw=(()=>{switch(e.clear(),e.fill(0),mode){case"draw":e.ellipse(hx,hy,33,33);break;case"delete":e.image(eraser,hx,hy,33,33);break;case"move":e.image(cursor,hx,hy,33,33);break;case"confirm":case"cancel":default:e.ellipse(hx,hy,33,33)}})};let pointerP5=new p5(s3,"canvas_pointer");const s4=e=>{e.preload=(()=>{confirmImage=e.loadImage("Thumbs-up.png"),rejectImage=e.loadImage("Thumbs-down.png"),helpScreen=e.loadImage("HelpScreen.png")}),e.setup=(()=>{e.createCanvas(document.getElementById("canvas_image").offsetWidth,document.documentElement.clientHeight),e.noStroke()}),e.draw=(()=>{selectedHelpButton?(e.imageMode(e.CENTER),e.image(helpScreen,document.getElementById("canvas_image").offsetWidth/2,document.documentElement.clientHeight/2)):1==hasCheckedLetter?charactersWhiteList.includes(letterToShow)?(e.image(rejectImage,document.getElementById("canvas_image").offsetWidth/20,document.documentElement.clientHeight/3*1.5,250,250),e.image(confirmImage,document.getElementById("canvas_image").offsetWidth/20*14,document.documentElement.clientHeight/3*1.5,250,250)):processErrorText.show(oops):processing?processingText.show(loading):(processErrorText.show(""),e.clear(),e.fill(0))})};let imagesP5=new p5(s4,"canvas_image");